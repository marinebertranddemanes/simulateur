<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Simulateur investissement locatif</title>

  <!-- Import police Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Import Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Montserrat', Arial, sans-serif;
    }

    #resultats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    .projet-card {
      background: #fff;
      border: 1px solid #eee;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      position: relative;
    }

    .badge {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 14px;
      color: #fff;
    }

    .badge.ok { background: #4CAF50; }
    .badge.nok { background: #c62828; }

    .ok-card { background:#f0fdf4; border:2px solid #4CAF50; }
    .nok-card { background:#fff5f5; border:2px solid #c62828; }

    .tabs { display:none; }
    .tab-btn.active { background:#0b1d2d; color:#fff; }
    .tab-content { display:none; }
    .tab-content.active { display:block; }

    @media (max-width:1024px) {
      #resultats { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width:768px) {
      #resultats { display:none; }
      .tabs, #tabContents { display:block; }
    }
  </style>
</head>
<body>

<section style="background:#f9f9fb; padding:60px 20px;">
  <div style="max-width:1200px; margin:0 auto;">

    <h2 style="font-size:32px; font-weight:700; margin-bottom:40px; color:#0b1d2d; text-align:center;">
      Définir mon projet d’investissement locatif
    </h2>

    <!-- Formulaire -->
    <div style="background:#fff; border:1px solid #ddd; border-radius:16px; padding:40px; margin-bottom:30px;">
      <form id="simForm" style="display:grid; grid-template-columns:1fr 1fr; gap:30px;">
        <div>
          <label>Revenus nets annuels du foyer (€)</label><br>
          <input type="number" id="revenus" placeholder="ex : 68 000">
        </div>
        <div>
          <label>Charges du foyer (€ / mois)</label><br>
          <input type="number" id="charges" placeholder="ex : 950">
        </div>
        <div>
          <label>Âge de la personne la + âgée</label><br>
          <input type="number" id="age" placeholder="ex : 45">
        </div>
        <div>
          <label>Apport prêt à mettre (€)</label><br>
          <input type="number" id="apport" placeholder="ex : 20 000">
        </div>
        <div style="grid-column:span 2; text-align:center;">
          <button type="button" onclick="calculerSimulation()">Définir mon projet d’investissement →</button>
        </div>
      </form>
    </div>

    <!-- Mention globale -->
    <div id="mentionGlobale" style="display:none; margin-bottom:25px; padding:15px; background:#fff8e6; border:1px solid #d9c9a3; border-radius:8px; text-align:center;">
      ⚠️ Les montants ci-dessous sont indicatifs. Le cabinet affine votre budget et vos mensualités.
    </div>

    <div id="resultats"></div>
    <div id="tabs" class="tabs"></div>
    <div id="tabContents"></div>

  </div>
</section>

<script>
function calculerSimulation() {
  const revenusAnnuel = parseFloat(document.getElementById("revenus").value) || 0;
  const chargesMensuelles = parseFloat(document.getElementById("charges").value) || 0;
  const apport = parseFloat(document.getElementById("apport").value) || 0;
  const revenusMensuels = revenusAnnuel / 12;

  const projets = [
    { id: 1, titre: "Projet Studio", loyer: 575, min: 140000, pdf: "https://marinebertranddemanes.github.io/simulateur/pdf/studio.pdf" },
    { id: 2, titre: "Projet T2", loyer: 725, min: 160000, pdf: "https://marinebertranddemanes.github.io/simulateur/pdf/t2.pdf" },
    { id: 3, titre: "Projet Colocation", loyer: 2000, min: 270000, pdf: "https://marinebertranddemanes.github.io/simulateur/pdf/colocation.pdf" }
  ];

  const scenarios = [
    { nom: "Emprunt sur 15 ans", duree: 15*12, taux: 0.0342 },
    { nom: "Emprunt sur 20 ans", duree: 20*12, taux: 0.0362 },
    { nom: "Emprunt sur 25 ans", duree: 25*12, taux: 0.0382 }
  ];

  document.getElementById("mentionGlobale").style.display = "block";
  document.getElementById("resultats").innerHTML = "";
  document.getElementById("tabs").innerHTML = "";
  document.getElementById("tabContents").innerHTML = "";

  scenarios.forEach((sc, idx) => {
    let colHTML = `<div><h3>${sc.nom}</h3>`;
    projets.forEach((projet) => { colHTML += getProjetHTML(projet, sc, revenusMensuels, chargesMensuelles, apport); });
    colHTML += `</div>`;
    document.getElementById("resultats").innerHTML += colHTML;

    const tabBtn = document.createElement("button");
    tabBtn.className = "tab-btn" + (idx === 0 ? " active" : "");
    tabBtn.innerText = sc.nom;
    tabBtn.onclick = () => showTab(idx);
    document.getElementById("tabs").appendChild(tabBtn);

    let html = `<div class="tab-content ${idx === 0 ? "active" : ""}" id="tab-${idx}">`;
    projets.forEach((projet) => { html += getProjetHTML(projet, sc, revenusMensuels, chargesMensuelles, apport); });
    html += `</div>`;
    document.getElementById("tabContents").innerHTML += html;
  });
}

function getProjetHTML(projet, sc, revenusMensuels, chargesMensuelles, apport) {
  const capaciteMensuelle = ((revenusMensuels + projet.loyer*0.7) * 0.35) - chargesMensuelles;
  if (capaciteMensuelle <= 0) {
    return `<div class="projet-card nok-card"><div class="badge nok">❌ Non possible</div><h4>${projet.titre}</h4><p>Revenus trop faibles</p></div>`;
  }

  const tauxMensuel = sc.taux / 12;
  const capital = capaciteMensuelle * (1 - Math.pow(1 + tauxMensuel, -sc.duree)) / tauxMensuel;
  const budgetTotal = capital + apport;

  if (budgetTotal >= projet.min * 0.995) {
    return `<div class="projet-card ok-card">
      <div class="badge ok">✅ Projet possible</div>
      <h4>${projet.titre}</h4>
      <p>Budget total ≈ ${(Math.round(budgetTotal/5000)*5000).toLocaleString("fr-FR")} €</p>
      <div style="text-align:center; margin-top:12px;">
        <a href="${projet.pdf}" target="_blank" rel="noopener noreferrer"
           style="padding:10px 18px; background:#0b1d2d; color:#fff; border-radius:6px; text-decoration:none; font-weight:600;">
           Voir un exemple
        </a>
      </div>
    </div>`;
  } else {
    return `<div class="projet-card nok-card"><div class="badge nok">❌ Non possible</div><h4>${projet.titre}</h4><p>Il manquerait ≈ ${(projet.min - budgetTotal).toLocaleString("fr-FR")} €</p></div>`;
  }
}

function showTab(index) {
  document.querySelectorAll(".tab-btn").forEach((btn, i) => {
    btn.classList.toggle("active", i === index);
  });
  document.querySelectorAll(".tab-content").forEach((tab, i) => {
    tab.classList.toggle("active", i === index);
  });
}
</script>

</body>
</html>
